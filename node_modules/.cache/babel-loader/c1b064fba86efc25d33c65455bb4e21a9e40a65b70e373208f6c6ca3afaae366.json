{"ast":null,"code":"import { __extends } from \"tslib\";\nimport React from 'react';\nimport styles from './SpriteAnimator.scss';\nimport { ease } from '../common';\nvar DEFAULT_POSITION = {\n  top: 0,\n  left: 0,\n  width: '100%',\n  height: '100%'\n};\nvar SpriteAnimator = /** @class */function (_super) {\n  __extends(SpriteAnimator, _super);\n  function SpriteAnimator() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.state = {\n      frame: 0\n    };\n    _this._playAnimation = function () {\n      _this._animationFrame = requestAnimationFrame(_this._onAnimate);\n    };\n    _this._onAnimate = function (timestamp) {\n      var _a = _this.props,\n        numOfFrames = _a.numOfFrames,\n        loop = _a.loop,\n        easing = _a.easing,\n        duration = _a.duration,\n        onSequenceEnd = _a.onSequenceEnd,\n        onAnimationStop = _a.onAnimationStop;\n      if (!_this._animationStart) {\n        _this._animationStart = timestamp;\n      }\n      var nextFrame = Math.floor(ease(easing)(timestamp - _this._animationStart, 0, numOfFrames, duration));\n      if (nextFrame > numOfFrames - 1) {\n        if (onSequenceEnd) {\n          onSequenceEnd();\n        }\n        if (loop) {\n          nextFrame %= numOfFrames;\n          _this._animationStart = timestamp;\n        } else {\n          nextFrame = -1;\n        }\n      }\n      if (nextFrame > -1) {\n        _this.setState({\n          frame: nextFrame\n        }, function () {\n          _this._playAnimation();\n        });\n      } else if (onAnimationStop) {\n        onAnimationStop();\n      }\n    };\n    return _this;\n  }\n  SpriteAnimator.prototype.componentDidMount = function () {\n    var autoplay = this.props.autoplay;\n    if (autoplay) {\n      this.start();\n    }\n  };\n  SpriteAnimator.prototype.componentDidUpdate = function (nextProps) {\n    if (nextProps.numOfFrames !== this.props.numOfFrames) {\n      this.start();\n    }\n  };\n  SpriteAnimator.prototype.componentWillUnmount = function () {\n    cancelAnimationFrame(this._animationFrame);\n  };\n  SpriteAnimator.prototype.start = function () {\n    this._animationStart = null;\n    this._playAnimation();\n  };\n  SpriteAnimator.prototype.stop = function () {\n    var onAnimationStop = this.props.onAnimationStop;\n    cancelAnimationFrame(this._animationFrame);\n    if (onAnimationStop) {\n      onAnimationStop();\n    }\n  };\n  SpriteAnimator.prototype.reset = function () {\n    this.setState({\n      frame: 0\n    });\n  };\n  SpriteAnimator.prototype.render = function () {\n    var frame = this.state.frame;\n    var _a = this.props,\n      getPosition = _a.getPosition,\n      children = _a.children;\n    var _b = getPosition(frame),\n      width = _b.width,\n      height = _b.height,\n      top = _b.top,\n      left = _b.left;\n    return React.createElement(\"div\", {\n      className: styles.wrapper,\n      style: {\n        width: width,\n        height: height\n      }\n    }, React.createElement(\"div\", {\n      className: styles.innerWrapper,\n      style: {\n        top: -top,\n        left: -left\n      }\n    }, React.Children.only(children)));\n  };\n  SpriteAnimator.displayName = 'SpriteAnimator';\n  SpriteAnimator.defaultProps = {\n    autoplay: true,\n    easing: 'linear',\n    loop: true,\n    numOfFrames: 0,\n    getPosition: function () {\n      return DEFAULT_POSITION;\n    }\n  };\n  return SpriteAnimator;\n}(React.Component);\nexport { SpriteAnimator };","map":{"version":3,"names":["React","styles","ease","DEFAULT_POSITION","top","left","width","height","SpriteAnimator","_super","__extends","_this","apply","arguments","state","frame","_playAnimation","_animationFrame","requestAnimationFrame","_onAnimate","timestamp","_a","props","numOfFrames","loop","easing","duration","onSequenceEnd","onAnimationStop","_animationStart","nextFrame","Math","floor","setState","prototype","componentDidMount","autoplay","start","componentDidUpdate","nextProps","componentWillUnmount","cancelAnimationFrame","stop","reset","render","getPosition","children","_b","createElement","className","wrapper","style","innerWrapper","Children","only","displayName","defaultProps","Component"],"sources":["../../../src/SpriteAnimator/SpriteAnimator.tsx"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}